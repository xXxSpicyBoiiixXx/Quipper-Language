<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Haskell code</title>
</head>
<body>
<pre><a name="line-1"></a><font color=Green><u>module</u></font> Quipper.Libraries.ClassicalOptim.QuickCheckAlgExp <font color=Green><u>where</u></font>
<a name="line-2"></a>
<a name="line-3"></a><font color=Green><u>import</u></font> <font color=Green><u>qualified</u></font> Test.QuickCheck <font color=Green><u>as</u></font> Test
<a name="line-4"></a>
<a name="line-5"></a><font color=Green><u>import</u></font> <font color=Green><u>qualified</u></font> Data.Map <font color=Green><u>as</u></font> M
<a name="line-6"></a><font color=Green><u>import</u></font> <font color=Green><u>qualified</u></font> Data.List <font color=Green><u>as</u></font> L
<a name="line-7"></a><font color=Green><u>import</u></font> <font color=Green><u>qualified</u></font> Data.Set <font color=Green><u>as</u></font> S
<a name="line-8"></a><font color=Green><u>import</u></font> <font color=Green><u>qualified</u></font> Data.IntSet <font color=Green><u>as</u></font> IS
<a name="line-9"></a><font color=Green><u>import</u></font> <font color=Green><u>qualified</u></font> Data.IntMap.Strict <font color=Green><u>as</u></font> IM <font color=Blue><i>{- containers-0.5.2.1 -}</i></font>
<a name="line-10"></a>
<a name="line-11"></a><font color=Green><u>import</u></font> Quipper.Utils.Auxiliary <font color=Cyan>(</font>bool_xor<font color=Cyan>)</font>
<a name="line-12"></a>
<a name="line-13"></a><font color=Green><u>import</u></font> Quipper.Libraries.ClassicalOptim.Circuit
<a name="line-14"></a>
<a name="line-15"></a><font color=Green><u>import</u></font> Quipper.Libraries.ClassicalOptim.AlgExp
<a name="line-16"></a>
<a name="line-17"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-18"></a><font color=Blue><i>-- ** Quick-checking</i></font>
<a name="line-19"></a>
<a name="line-20"></a><a name="twoExp"></a><font color=Blue><i>-- | Compute 2[sup /n/].</i></font>
<a name="line-21"></a><font color=Blue>twoExp</font> <font color=Red>::</font> <font color=Cyan>(</font>Integral a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> Int
<a name="line-22"></a><font color=Blue>twoExp</font> <font color=Magenta>0</font> <font color=Red>=</font> <font color=Magenta>1</font>
<a name="line-23"></a><font color=Blue>twoExp</font> n <font color=Red>|</font> mod n <font color=Magenta>2</font> <font color=Cyan>==</font> <font color=Magenta>0</font> <font color=Red>=</font> <font color=Green><u>let</u></font> a <font color=Red>=</font> twoExp <font color=Cyan>(</font>div n <font color=Magenta>2</font><font color=Cyan>)</font> <font color=Green><u>in</u></font> a <font color=Cyan>*</font> a
<a name="line-24"></a>         <font color=Red>|</font> otherwise <font color=Red>=</font> <font color=Magenta>2</font> <font color=Cyan>*</font> <font color=Cyan>(</font>twoExp <font color=Cyan>(</font>n<font color=Blue><i>-</i></font><font color=Magenta>1</font><font color=Cyan>)</font><font color=Cyan>)</font>
<a name="line-25"></a>
<a name="line-26"></a><a name="genBoolList"></a><font color=Blue><i>-- | Generate a list of 'Bool'.</i></font>
<a name="line-27"></a><font color=Blue>genBoolList</font> <font color=Red>::</font> Integral a <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> Test.Gen <font color=Red>[</font>Bool<font color=Red>]</font>
<a name="line-28"></a><font color=Blue>genBoolList</font> n <font color=Red>=</font> Test.vectorOf <font color=Cyan>(</font>twoExp n<font color=Cyan>)</font> <font color=Cyan>$</font> Test.oneof <font color=Red>[</font>return True<font color=Cyan>,</font> return False<font color=Red>]</font>
<a name="line-29"></a>
<a name="line-30"></a><a name="test_args"></a><font color=Blue><i>-- | Arguments for QuickCheck.</i></font>
<a name="line-31"></a><font color=Blue>test_args</font> <font color=Red>::</font> Test.Args
<a name="line-32"></a><font color=Blue>test_args</font> <font color=Red>=</font> Test.stdArgs <font color=Cyan>{</font> Test.maxSize <font color=Red>=</font> <font color=Magenta>100</font><font color=Cyan>,</font> 
<a name="line-33"></a>                           Test.maxSuccess <font color=Red>=</font> <font color=Magenta>100</font><font color=Cyan>,</font> 
<a name="line-34"></a>                           Test.maxDiscardRatio <font color=Red>=</font> <font color=Magenta>20</font> <font color=Cyan>}</font>
<a name="line-35"></a>
<a name="line-36"></a><a name="test_truth1"></a><font color=Blue><i>-- | First test: truth table to expression to truth table is the identity.</i></font>
<a name="line-37"></a><font color=Blue>test_truth1</font> <font color=Red>::</font> Int <font color=Red>-&gt;</font> IO ()
<a name="line-38"></a><font color=Blue>test_truth1</font> n <font color=Red>=</font> Test.quickCheckWith test_args  <font color=Cyan>$</font> aux
<a name="line-39"></a>  <font color=Green><u>where</u></font>
<a name="line-40"></a>    aux <font color=Red>=</font> Test.forAll <font color=Cyan>(</font>genBoolList n<font color=Cyan>)</font> <font color=Cyan>$</font> <font color=Red>\</font>x <font color=Red>-&gt;</font>
<a name="line-41"></a>      x <font color=Cyan>==</font> <font color=Cyan>(</font>truth_table_of_exp <font color=Red>[</font><font color=Magenta>1</font><font color=Red>..</font>n<font color=Red>]</font> <font color=Cyan>$</font> exp_of_truth_table <font color=Magenta>1</font> x<font color=Cyan>)</font>
<a name="line-42"></a>
<a name="line-43"></a><a name="genIntList"></a><font color=Blue><i>-- | Generate a random list of @Int@s.</i></font>
<a name="line-44"></a><font color=Blue>genIntList</font> <font color=Red>::</font> <font color=Red>[</font>Int<font color=Red>]</font> <font color=Red>-&gt;</font> Int <font color=Red>-&gt;</font> Test.Gen <font color=Red>[</font>Int<font color=Red>]</font>
<a name="line-45"></a><font color=Blue>genIntList</font> vars size <font color=Red>=</font> <font color=Green><u>do</u></font>
<a name="line-46"></a>  s <font color=Red>&lt;-</font> Test.choose <font color=Cyan>(</font><font color=Magenta>0</font><font color=Cyan>,</font>size<font color=Cyan>)</font>
<a name="line-47"></a>  Test.vectorOf s <font color=Cyan>$</font> Test.elements vars
<a name="line-48"></a>
<a name="line-49"></a><a name="genExp"></a><font color=Blue><i>-- | Generate a random expression out of the given variables.</i></font>
<a name="line-50"></a><font color=Blue>genExp</font> <font color=Red>::</font> <font color=Red>[</font>Int<font color=Red>]</font> <font color=Red>-&gt;</font> Test.Gen Exp
<a name="line-51"></a><font color=Blue>genExp</font> vars <font color=Red>=</font> <font color=Green><u>do</u></font>
<a name="line-52"></a>  nber <font color=Red>&lt;-</font> Test.choose <font color=Cyan>(</font><font color=Magenta>0</font><font color=Cyan>,</font> twoExp <font color=Cyan>(</font>length vars<font color=Cyan>)</font><font color=Cyan>)</font>
<a name="line-53"></a>  v <font color=Red>&lt;-</font> Test.vectorOf nber <font color=Cyan>$</font> Test.sized <font color=Cyan>$</font> genIntList vars
<a name="line-54"></a>  return <font color=Cyan>$</font> expOfList v
<a name="line-55"></a>
<a name="line-56"></a><a name="test_truth2"></a><font color=Blue><i>-- | Second test: expression to truth table to expression is the</i></font>
<a name="line-57"></a><font color=Blue><i>-- identity.</i></font>
<a name="line-58"></a><font color=Blue>test_truth2</font> <font color=Red>::</font> Int <font color=Red>-&gt;</font> IO Test.Result
<a name="line-59"></a><font color=Blue>test_truth2</font> n <font color=Red>=</font> Test.quickCheckWithResult test_args <font color=Cyan>$</font> aux
<a name="line-60"></a>  <font color=Green><u>where</u></font>
<a name="line-61"></a>    aux <font color=Red>=</font> Test.forAll <font color=Cyan>(</font>genExp <font color=Red>[</font><font color=Magenta>1</font><font color=Red>..</font>n<font color=Red>]</font><font color=Cyan>)</font> <font color=Cyan>$</font> <font color=Red>\</font>x <font color=Red>-&gt;</font>
<a name="line-62"></a>      x <font color=Cyan>==</font> <font color=Cyan>(</font>exp_of_truth_table <font color=Magenta>1</font> <font color=Cyan>$</font> truth_table_of_exp <font color=Red>[</font><font color=Magenta>1</font><font color=Red>..</font>n<font color=Red>]</font> x<font color=Cyan>)</font>
<a name="line-63"></a>
<a name="line-64"></a>
</pre>
</body>
</html>